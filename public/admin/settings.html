<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pengaturan - Admin</title>
    
    <link rel="stylesheet" href="../css/style.css">

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0F172A">
    <link rel="apple-touch-icon" href="/assets/images/icon.png">
    
    <script src="/js/pwa-register.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="../js/auth.js"></script>
    <script>checkAuth();</script>

    <style>
        /* CSS Banner Upload */
        .banner-group {
            background: #0F172A; padding: 1rem; border-radius: 12px; margin-bottom: 1.5rem; border: 1px solid #334155;
            text-align: center; /* Rata tengah biar rapi */
        }
        .banner-group h4 { color: #4ADE80; margin-bottom: 1rem; text-align: left; }
        .preview-box {
            width: 100%; height: 150px; /* Sedikit lebih tinggi biar puas lihat gambarnya */
            background: #1E293B; border-radius: 10px; 
            display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 15px;
            border: 2px dashed #334155; position: relative;
        }
        .preview-box img { width: 100%; height: 100%; object-fit: cover; position: absolute; top:0; left:0; }
        .preview-box .placeholder { color: #64748b; font-size: 0.8rem; }
        
        /* Tombol Upload dipercantik */
        .btn-upload {
            display: inline-block; padding: 10px 20px; 
            background: #334155; color: white; 
            border-radius: 8px; cursor: pointer; font-size: 0.9rem;
            transition: 0.3s; width: 100%;
            border: 1px solid #475569;
        }
        .btn-upload:hover { background: #475569; }
        .btn-upload input { display: none; }
    </style>
</head>
<body>

    <div class="mobile-container">
        <header class="main-header">
            <a href="dashboard.html" class="btn-back"><i class="fa-solid fa-arrow-left"></i></a>
            <div class="logo-text">Pengaturan Toko</div>
        </header>

        <main class="settings-page">
            
            <div class="settings-tabs">
                <button class="tab-btn active" onclick="switchTab('tab-umum')">Umum</button>
                <button class="tab-btn" onclick="switchTab('tab-kontak')">Kontak WA</button>
                <button class="tab-btn" onclick="switchTab('tab-banner')">Banner</button>
            </div>

            <div id="tab-umum" class="tab-content active">
                <div class="setting-card" style="border: 1px solid #4ADE80;">
                    <h3 style="color:#4ADE80;"><i class="fa-solid fa-store"></i> Pengaturan Toko</h3>
                    <p style="color:#94a3b8; font-size:0.8rem; margin-bottom:1rem;">Atur keuntungan dan identitas toko.</p>

                    <div class="form-group">
                        <label>Nama Toko</label>
                        <input type="text" id="siteName" placeholder="RinsPoint">
                    </div>
                    
                    <div class="form-group">
                        <label>Margin PPOB</label>
                        <input type="number" id="ppobMargin" placeholder="500" style="font-weight:bold; color:#F59E0B;">
                    </div>

                    <button class="btn-save" onclick="saveGeneral()">SIMPAN PENGATURAN TOKO</button>
                </div>

                <div class="setting-card" style="margin-top: 2rem;">
                    <h3><i class="fa-solid fa-user-shield"></i> Ganti Akun Admin</h3>
                    <div class="form-group">
                        <label>Email Login Baru</label>
                        <input type="email" id="newEmail" placeholder="admin@baru.com">
                    </div>
                    <div class="form-group">
                        <label>Password Baru</label>
                        <div style="position:relative;">
                            <input type="password" id="newPassword" placeholder="******">
                            <i class="fa-solid fa-eye" onclick="togglePass('newPassword')" style="position:absolute; right:10px; top:12px; color:#94a3b8; cursor:pointer;"></i>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Konfirmasi Password</label>
                        <div style="position:relative;">
                            <input type="password" id="confirmPassword" placeholder="******">
                        </div>
                    </div>
                    <button class="btn-save" onclick="updateAdminAccount()">UPDATE AKUN LOGIN</button>
                </div>
            </div>

            <div id="tab-kontak" class="tab-content">
                <div class="setting-card">
                    <h3>Tambah Admin WhatsApp</h3>
                    <div class="form-group">
                        <label>Nama Admin</label>
                        <input type="text" id="adminName" placeholder="Contoh: Admin 1">
                    </div>
                    <div class="form-group">
                        <label>Nomor WhatsApp (628...)</label>
                        <input type="number" id="adminPhone" placeholder="628123456789">
                    </div>
                    <button class="btn-save" onclick="addContact()">+ Tambah Kontak</button>
                </div>

                <div class="setting-card">
                    <h3>Daftar Kontak Aktif</h3>
                    <div id="contactsList">
                        <p style="color:#94a3b8; font-size:0.9rem;">Memuat kontak...</p>
                    </div>
                </div>
            </div>

            <div id="tab-banner" class="tab-content">
                <div class="setting-card">
                    <h3>Kelola Banner Utama</h3>
                    <p style="color:#94a3b8; font-size:0.8rem; margin-bottom:1.5rem;">Upload gambar banner saja (Rasio 2:1).</p>

                    <form id="bannerForm" enctype="multipart/form-data">
                        
                        <div class="banner-group">
                            <h4>Banner 1</h4>
                            <div class="preview-box" id="preview1">
                                <img src="" alt="Preview" style="display:none;">
                                <span class="placeholder">Belum ada gambar</span>
                            </div>
                            <label class="btn-upload">
                                <i class="fa-solid fa-upload"></i> Pilih Gambar Banner 1
                                <input type="file" name="banner1_image" accept="image/*" onchange="previewBanner(this, 'preview1')">
                            </label>
                        </div>

                        <div class="banner-group">
                            <h4>Banner 2</h4>
                            <div class="preview-box" id="preview2">
                                <img src="" alt="Preview" style="display:none;">
                                <span class="placeholder">Belum ada gambar</span>
                            </div>
                            <label class="btn-upload">
                                <i class="fa-solid fa-upload"></i> Pilih Gambar Banner 2
                                <input type="file" name="banner2_image" accept="image/*" onchange="previewBanner(this, 'preview2')">
                            </label>
                        </div>

                        <div class="banner-group">
                            <h4>Banner 3</h4>
                            <div class="preview-box" id="preview3">
                                <img src="" alt="Preview" style="display:none;">
                                <span class="placeholder">Belum ada gambar</span>
                            </div>
                            <label class="btn-upload">
                                <i class="fa-solid fa-upload"></i> Pilih Gambar Banner 3
                                <input type="file" name="banner3_image" accept="image/*" onchange="previewBanner(this, 'preview3')">
                            </label>
                        </div>

                        <button type="submit" class="btn-save" id="btnSaveBanner">UPLOAD SEMUA BANNER</button>
                    </form>
                </div>
            </div>

        </main>
    </div>

    <script>
        function togglePass(id) {
            const input = document.getElementById(id);
            input.type = input.type === 'password' ? 'text' : 'password';
        }
    </script>

    <script src="../js/settings.js"></script>
</body>
</html>